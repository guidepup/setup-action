"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.record = void 0;
const child_process_1 = require("child_process");
const path_1 = require("path");
const fs_1 = require("fs");
/**
 * Start a screen recording.
 *
 * @param {string} filepath The file path to save the screen recording to.
 * @returns {Function} A function to stop the screen recording.
 */
function record(filepath) {
    (0, child_process_1.execSync)(`mkdir -p ${(0, path_1.dirname)(filepath)}`);
    try {
        (0, fs_1.unlinkSync)(filepath);
    }
    catch (_) {
        // file doesn't exist.
    }
    const screencapture = (0, child_process_1.spawn)("/usr/sbin/screencapture", [
        "-v",
        "-C",
        "-k",
        "-T0",
        "-g",
        filepath,
    ]);
    return () => {
        screencapture.stdin.write("q");
    };
}
exports.record = record;
