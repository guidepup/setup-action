"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setup = void 0;
const getNvdaRegistryData_1 = require("./getNvdaRegistryData");
const isNvdaInstalled_1 = require("./isNvdaInstalled");
const createNvdaRegistryKey_1 = require("./createNvdaRegistryKey");
const installNvda_1 = require("./installNvda");
const updateNvdaRegistryData_1 = require("./updateNvdaRegistryData");
const removeForegroundLock_1 = require("./removeForegroundLock");
const restartExplorer_1 = require("./restartExplorer");
async function setup() {
    const { exists, values } = await (0, getNvdaRegistryData_1.getNvdaRegistryData)();
    if ((0, isNvdaInstalled_1.isNvdaInstalled)({ exists, values })) {
        return;
    }
    if (!exists) {
        await (0, createNvdaRegistryKey_1.createNvdaRegistryKey)();
    }
    const nvdaDirectory = await (0, installNvda_1.installNvda)();
    await (0, updateNvdaRegistryData_1.updateNvdaRegistryData)({ nvdaDirectory });
    await (0, removeForegroundLock_1.removeForegroundLock)();
    await (0, restartExplorer_1.restartExplorer)();
}
exports.setup = setup;
